---
path: "/tutorials/deploy-github-artifacts-to-storagebox"
slug: "deploy-github-artifacts-to-storagebox"
date: "2023-08-19"
title: "Deploy GitHub artifacts to Hetzner Storagebox over SSH"
short_description: "In this tutorial, we will deploy artifacts built with GitHub actions onto a Hetzner Storagebox over SSH"
tags: ["SSH", "GitHub", "storagebox"]
author: "Harshavardhan Musanalli"
author_link: "https://github.com/harshavmb"
author_img: "https://avatars.githubusercontent.com/u/10049720?v=4"
author_description: ""
language: "en"
available_languages: ["en"]
header_img: "header-3"
cta: "cloud"
---

## Introduction

In this tutorial, we will guide you through the process of deploying a GitHub artifact to Hetzner Storage Box over SSH. Hetzner Storage Box is a cloud storage solution that allows you to store and serve files securely. Whether you have a compiled application, a website, or any other file to host, this step-by-step guide will help you get it up and running in no time.

## Prerequisites

Before we dive into the deployment process, make sure you have the following prerequisites in place:

1. **GitHub Repository**: You should have a GitHub repository containing the artifact you want to deploy.

2. **Hetzner Storage Box**: Ensure you have an active Hetzner Storage Box account, the necessary SSH access credentials & the external connectivity enabled.

3. **SSH Client**: Have an SSH client installed on your local machine. If you're using Linux or macOS, you can use the built-in SSH client. On Windows, you can use PuTTY or another SSH client of your choice.

## Step 1 - Creating an SSH key pair

We need to generate a key pair. If a key pair already exists, this step can of course be skipped.

Users haunted by Windows can, for example, use the [PuTTYgen](https://www.puttygen.com/) program to create a key pair.

Under GNU/Linux we can create a key pair with the following command.

```bash
ssh-keygen \
  -o \
  -a 100 \
  -t ed25519 \
  -f ~/.ssh/id_ed25519 \
  -C "$(whoami)@$(hostname)"
```

The key pair (consisting of the files `id_ed25519` and `id_ed25519.pub`) should now be located in the local user's home directory under `~/.ssh`. *The private key (the file without .pub) should be kept safe, similar to a password, and not passed on.*

It is users choice to use either `ed25519` or `rsa`. Both the algorithms are supported by storage box.

## Step 2 - Upload the public key to storage box

To be able to authenticate ourselves with our private key, the public key must be added to the storage box. It is highly recommended to create a sub account restricted to a base folder within the storage box. 

When a sub account is created, a username & password are shared by Hetzner (in an ephemeral way). You can connect to the storage box base directory with those credentials to setup the public key. 

If you have mounted the storage box on a vm, you can switch to the base directory on that storage box & setup these credentials directly over there, no need of using `scp` or `rsync`.

If you are using storage box in an unmounted way, you can logon with storage box credentials & create `.ssh` directory. 
There are various ways of copying the files to storage box, I'm using `scp` in the below example. You can use `rsync` too. 

```bash
xxxxx-sub2 /home > mkdir .ssh
total 77
-rw-r--r--  1 xxxxx-sub2  1008  1386 Aug 18 09:30 authorized_keys
drwxr-xr-x  5 xxxxx-sub2  1008     6 Aug 19 12:00 ..
drwxr-xr-x  2 xxxxx-sub2  1008     4 Aug 19 12:05 .

Harshas-MacBook-Pro:~ harshavmb$ scp -P 23  -r /.ssh/id_ed25519.pub xxxxx-sub2@xxxxx.your-storagebox.de:/.ssh/authorized_keys
authorized_keys              100%  408    13.5KB/s   00:00 
```

**Important**: *Hetzner storage boxes only accept SSH connections on port 23. Hence, you must specify port 23 while connecting as ssh defaults to port 22*

## Step 3 - Configure GitHub Repository Secrets

To securely store your Hetzner Storage Box credentials and SSH private key for GitHub Actions, you should use GitHub Repository Secrets.

1. Navigate to your GitHub repository.

2. Go to the "Settings" tab.

3. In the left sidebar, click on "Secrets."

4. Click the "New repository secret" button.

Name it something like `HETZNER_SSH_KEY` and paste your SSH private key as the value.
Name another secret `HETZNER_USERNAME` and set it as your Hetzner Storage Box username.
Name another secret `HETZNER_HOST` and set it as the hostname for your Hetzner Storage Box.

```yaml
#sample CD file
name: Deploy to Hetzner Storage Box
on: push
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Set up SSH key
        run: |
          env
          mkdir -p ~/.ssh
          echo "${{ secrets.HETZNER_SSH_KEY }}" > ~/.ssh/id_ed25519
          chmod 600 ~/.ssh/id_ed25519
          ssh-keyscan -p 23 -t ed25519 ${{ secrets.HETZNER_HOST }} >> ~/.ssh/known_hosts

      - name: Deploy to Hetzner Storage Box
        run: |
          rsync -azP -e "ssh -i $HOME/.ssh/id_ed25519 -p 23" your-artifact.ext ${{ secrets.HETZNER_USERNAME }}@${{ secrets.HETZNER_HOST }}:/path/to/destination/          
```

Make sure to replace `your-artifact.ext` with the actual name of your artifact and `/path/to/destination/` with the destination path on Hetzner Storage Box.

**Note**: *In above GitHub workflow rsync is used but scp could also be used. Both binaries are available on ubuntu-latest image*

## Step 4 - Trigger the Workflow

Push your changes to your GitHub repository, and the GitHub Actions workflow will be triggered automatically. It will build and deploy your artifact to Hetzner Storage Box whenever there is a push to the branch.

## Advantages

Storing artifacts built on GitHub to Hetzner Storage Box using a GitHub Actions workflow offers several advantages:

* **Automation**: Automating the process of building and deploying artifacts streamlines your development workflow. With GitHub Actions, you can trigger the deployment automatically whenever changes are pushed to your repository. This reduces manual intervention and potential human errors.

* **Consistency**: Automated deployments ensure consistency in the artifacts you store on Hetzner Storage Box. Every time you push changes to your repository, GitHub Actions will build and deploy the latest version, eliminating the risk of deploying outdated or incorrect files.

* **Version Control**: GitHub provides version control for your code and, by extension, your artifacts. Each deployment is associated with a specific commit or branch, making it easy to track changes and roll back to previous versions if necessary.

* **Security**: By using GitHub Secrets to store sensitive information like SSH keys and Hetzner Storage Box credentials, you can maintain a higher level of security. These secrets are encrypted and not exposed in your repository's history.

* **Scalability**: GitHub Actions can handle a variety of deployment scenarios, from simple artifact uploads to complex deployment pipelines. As your project grows, you can expand and customize your workflow to accommodate evolving needs.

* **Cost-Efficiency**: Hetzner Storage Box is a cost-effective solution for storing artifacts. You only pay for the storage you use, making it a budget-friendly choice, especially for long-term storage.

* **Accessibility**: Hetzner Storage Box allows you to serve your artifacts over the web, making them easily accessible to your team or end-users. You can share direct download links or embed the artifacts in your applications.

* **High Availability**: Hetzner Storage Box is designed to provide high availability and reliability. Your artifacts are stored on redundant storage systems, reducing the risk of data loss.

* **Performance**: Hetzner's infrastructure offers good performance, ensuring that your artifacts are served quickly to users, even if they are geographically distributed.

* **Flexibility**: This approach gives you the flexibility to deploy various types of artifacts, including websites, applications, data files, and more. You can tailor the GitHub Actions workflow to meet your specific deployment requirements.

* **Collaboration**: Multiple team members can collaborate on a project and use the same automated deployment process. This ensures that everyone is working with the latest version of the artifacts.

* **Monitoring and Logging**: GitHub Actions provides monitoring and logging capabilities, allowing you to track the progress of deployments, identify any issues, and receive notifications in case of failures.

Overall, automating artifact deployment from GitHub to Hetzner Storage Box enhances your development process, improves reliability, and ensures that your artifacts are readily available to your intended audience while maintaining security and cost-efficiency.

## Conclusion

That's it! You've successfully set up GitHub Actions to build and deploy artifacts to Hetzner Storage Box automatically. This workflow will make your deployment process more efficient and maintainable.

##### License: MIT

<!--

Contributor's Certificate of Origin

By making a contribution to this project, I certify that:

(a) The contribution was created in whole or in part by me and I have
    the right to submit it under the license indicated in the file; or

(b) The contribution is based upon previous work that, to the best of my
    knowledge, is covered under an appropriate license and I have the
    right under that license to submit that work with modifications,
    whether created in whole or in part by me, under the same license
    (unless I am permitted to submit under a different license), as
    indicated in the file; or

(c) The contribution was provided directly to me by some other person
    who certified (a), (b) or (c) and I have not modified it.

(d) I understand and agree that this project and the contribution are
    public and that a record of the contribution (including all personal
    information I submit with it, including my sign-off) is maintained
    indefinitely and may be redistributed consistent with this project
    or the license(s) involved.

Signed-off-by: Harshavardhan Musanalli<harshavmb@gmail.com>

-->