---
SPDX-License-Identifier: MIT
path: "/tutorials/restic-docker-backup"
slug: "restic-docker-backup"
title: "Restic docker backup"
short_description: "Backup your data with Restic Docker to Hetzner Storage Box"
tags: ["docker", "storage box", "backup", "restic"]
author: "Barna Barak"
language: "en"
available_languages: ["en"]
author_link: "https://github.com/bex1111"
---

## Introduction

In this tutorial you can find how to set up a basic Restic Docker and back up your data to Hetzner storage box.

## Create ssh key

Based on [this](https://docs.hetzner.com/storage/storage-box/backup-space-ssh-keys/).

Run ```ssh-keygen -f restic```  
Press Enter when asked for the passphrase. It means an empty passphrase.

Sync ssh key to your storage box.   
```ssh-copy-id -p 23 -i restic.pub -s uXXXXX@uXXXXX.your-storagebox.de```

Create a `config` file:
```config
    Host restic
        Hostname uXXXXX.your-storagebox.de
        Port 23
        User uXXXXX
        IdentityFile /root/.ssh/restic
```
- Host -> alias for your conf (See secret file below.)
- Hostname -> your storage url
- User -> your ssh user
- IdentityFile -> your private key location inside the docker

Create an `ssh` folder and copy the generated key and config file there.

You can validate your SSH config with the ssh command.  
If you can execute it and log in immediately, your SSH key was added correctly.
```
ssh -p 23 -i restic uXXXXX@uXXXXX.your-storagebox.de
```

## Docker

Create an restic env file:
```.env
RESTIC_REPOSITORY=sftp:restic:./backup
RESTIC_PASSWORD=yourpwforfileencryption
```

Init repository command
```
	docker run --rm --hostname restic -ti \
    --env-file /path/to/env/restic.env \
    -v /path/to/ssh:/root/.ssh \
    -v /path/to/cache:/root/.cache/restic \
    restic/restic init
```

Backup command for back up all folder under `/data`:
```
	docker run --rm --hostname restic -ti \
    --env-file /path/to/env/restic.env \
    -v /path/to/ssh:/root/.ssh \
    -v /path/to/cache:/root/.cache/restic \
    -v /path/to/backup/file/1:/data/1:ro \
    -v /path/to/backup/file/n:/data/n:ro \
    restic/restic backup /data
```

##### License: MIT

<!--

Contributor's Certificate of Origin

By making a contribution to this project, I certify that:

(a) The contribution was created in whole or in part by me and I have
    the right to submit it under the license indicated in the file; or

(b) The contribution is based upon previous work that, to the best of my
    knowledge, is covered under an appropriate license and I have the
    right under that license to submit that work with modifications,
    whether created in whole or in part by me, under the same license
    (unless I am permitted to submit under a different license), as
    indicated in the file; or

(c) The contribution was provided directly to me by some other person
    who certified (a), (b) or (c) and I have not modified it.

(d) I understand and agree that this project and the contribution are
    public and that a record of the contribution (including all personal
    information I submit with it, including my sign-off) is maintained
    indefinitely and may be redistributed consistent with this project
    or the license(s) involved.

Signed-off-by: Barna Barak

-->